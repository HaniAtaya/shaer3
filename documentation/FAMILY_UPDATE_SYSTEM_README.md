# نظام تحديث بيانات العائلات

## نظرة عامة
تم إنشاء نظام شامل لتحديث بيانات العائلات المسجلة مسبقاً في النظام. يتيح النظام للعائلات تحديث بياناتها باستخدام كلمة مرور مكونة من 8 أرقام.

## المميزات الرئيسية

### 1. توليد كلمة المرور التلقائية
- **المصدر**: يتم استخراج كلمة المرور من رقم الهوية أو تاريخ الميلاد
- **الطول**: 8 أرقام بالضبط
- **التوليد**: تلقائياً عند تسجيل العائلة لأول مرة

### 2. نظام تسجيل الدخول
- **الصفحة**: `family-login.php`
- **المتطلبات**: كلمة المرور المكونة من 8 أرقام
- **الأمان**: التحقق من صحة كلمة المرور في قاعدة البيانات

### 3. إجبار تغيير كلمة المرور
- **الصفحة**: `change-password.php`
- **المتطلبات**: إجبارية في أول دخول
- **التحقق**: كلمة مرور جديدة مختلفة عن الحالية

### 4. تحديث البيانات
- **الصفحة**: `family-update.php`
- **المميزات**: 
  - عرض البيانات الحالية
  - إمكانية تعديل جميع الحقول
  - حفظ التغييرات
  - تسجيل الخروج

## الملفات المضافة

### 1. قاعدة البيانات
- **الجدول**: `family_access_codes`
- **الملف**: `create_family_access_table.sql`
- **الوظيفة**: حفظ كلمات المرور وربطها بالعائلات

### 2. صفحات النظام
- `family-login.php` - تسجيل الدخول
- `change-password.php` - تغيير كلمة المرور
- `family-update.php` - تحديث البيانات
- `family-logout.php` - تسجيل الخروج

### 3. الملفات المساعدة
- `includes/generate-access-code.php` - دوال توليد وإدارة كلمات المرور

## كيفية الاستخدام

### للعائلات الجديدة:
1. تسجيل البيانات في `family-registration.php`
2. الحصول على كلمة المرور التلقائية
3. حفظ كلمة المرور في مكان آمن

### للعائلات المسجلة:
1. الذهاب إلى `family-login.php`
2. إدخال كلمة المرور المكونة من 8 أرقام
3. تغيير كلمة المرور (في أول دخول)
4. تحديث البيانات المطلوبة
5. حفظ التغييرات

## التحديثات المطبقة

### 1. صفحة تسجيل العائلة (`family-registration.php`)
- إضافة توليد كلمة المرور التلقائية
- عرض كلمة المرور بعد التسجيل
- حفظ كلمة المرور في قاعدة البيانات

### 2. الصفحة الرئيسية (`index.php`)
- إضافة زر "تحديث بيانات الأسرة"
- إضافة بطاقة مميزة لتحديث البيانات

## الأمان والحماية

### 1. التحقق من كلمة المرور
- فحص صحة التنسيق (8 أرقام)
- التحقق من وجودها في قاعدة البيانات
- ربط كلمة المرور بالعائلة الصحيحة

### 2. إدارة الجلسات
- تسجيل دخول آمن
- تدمير الجلسة عند الخروج
- التحقق من صحة الجلسة

### 3. حماية البيانات
- تنظيف المدخلات
- استخدام Prepared Statements
- تشفير كلمات المرور (يمكن إضافته لاحقاً)

## التطوير المستقبلي

### 1. إرسال الرسائل النصية
- ربط النظام بخدمة SMS
- إرسال كلمة المرور عبر الرسائل
- إشعارات التحديث

### 2. المزيد من الأمان
- تشفير كلمات المرور
- نظام استعادة كلمة المرور
- تسجيل محاولات الدخول

### 3. المميزات الإضافية
- تحديث بيانات أفراد الأسرة
- رفع الصور
- طباعة البيانات

## ملاحظات مهمة

1. **كلمة المرور**: يجب حفظها في مكان آمن
2. **التحديث**: يمكن تحديث البيانات في أي وقت
3. **الأمان**: لا تشارك كلمة المرور مع الآخرين
4. **الدعم**: في حالة نسيان كلمة المرور، تواصل مع الإدارة

## الدعم الفني

للمساعدة أو الاستفسارات، يرجى التواصل مع فريق الدعم الفني.
