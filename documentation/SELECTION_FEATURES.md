# ميزات التحديد والتصدير المتقدم - الشاعر عائلتي

## نظرة عامة
تم إضافة ميزات متقدمة للتحديد والتصدير في صفحات إدارة الرضع والوفيات، مما يتيح للمستخدمين تحديد عناصر محددة أو جميع العناصر وتصديرها.

## الميزات الجديدة

### 1. عمود التحديد (Selection Column)
- **الموقع**: أول عمود في الجداول
- **الوظائف**:
  - checkbox لتحديد عنصر واحد
  - checkbox رئيسي لتحديد/إلغاء تحديد الكل
  - حالة متوسطة (indeterminate) عند تحديد بعض العناصر

### 2. تحديد الكل (Select All)
- **الوظيفة**: تحديد أو إلغاء تحديد جميع العناصر في الصفحة
- **الحالات**:
  - ☐ غير محدد: لا توجد عناصر محددة
  - ☑ محدد: جميع العناصر محددة
  - ☐ متوسط: بعض العناصر محددة

### 3. التصدير المحدد (Selective Export)
- **Excel**: تصدير العناصر المحددة فقط إلى ملف CSV
- **PDF**: تصدير العناصر المحددة فقط إلى ملف PDF
- **الطباعة**: طباعة العناصر المحددة فقط

## كيفية الاستخدام

### في صفحة إدارة الرضع:
1. **تحديد عنصر واحد**: اضغط على checkbox بجانب العنصر المطلوب
2. **تحديد الكل**: اضغط على checkbox في رأس الجدول
3. **التصدير المحدد**: 
   - حدد العناصر المطلوبة
   - اضغط على "تصدير Excel" أو "تصدير PDF"
   - سيتم تصدير العناصر المحددة فقط

### في صفحة إدارة الوفيات:
1. **تحديد عنصر واحد**: اضغط على checkbox بجانب العنصر المطلوب
2. **تحديد الكل**: اضغط على checkbox في رأس الجدول
3. **التصدير المحدد**: 
   - حدد العناصر المطلوبة
   - اضغط على "تصدير Excel" أو "تصدير PDF"
   - سيتم تصدير العناصر المحددة فقط

## الوظائف التقنية

### JavaScript Functions:

#### للرضع:
- `toggleSelectAll()`: تحديد/إلغاء تحديد الكل
- `updateSelectAllStatus()`: تحديث حالة checkbox الرئيسي
- `getSelectedInfants()`: الحصول على العناصر المحددة
- `exportToExcel()`: تصدير Excel مع العناصر المحددة
- `exportToPDF()`: تصدير PDF مع العناصر المحددة

#### للوفيات:
- `toggleSelectAllDeaths()`: تحديد/إلغاء تحديد الكل
- `updateSelectAllDeathsStatus()`: تحديث حالة checkbox الرئيسي
- `getSelectedDeaths()`: الحصول على العناصر المحددة
- `exportToExcel()`: تصدير Excel مع العناصر المحددة
- `exportToPDF()`: تصدير PDF مع العناصر المحددة

### PHP Backend:

#### ملفات التصدير المحدثة:
- `export_infants_excel.php`: يدعم `selected_ids` parameter
- `export_deaths_excel.php`: يدعم `selected_ids` parameter
- `export_infants_pdf.php`: يدعم `selected_ids` parameter
- `export_deaths_pdf.php`: يدعم `selected_ids` parameter

#### معاملات التصفية:
- `selected_ids`: قائمة مفصولة بفواصل من معرفات العناصر المحددة
- يتم دمجها مع فلاتر البحث الأخرى (البحث، الفرع العائلي، المحافظة، إلخ)

## الميزات المتقدمة

### 1. التحديد الذكي
- **تحديد تلقائي**: عند تحديد جميع العناصر، يتم تحديد checkbox الرئيسي تلقائياً
- **إلغاء تحديد تلقائي**: عند إلغاء تحديد عنصر واحد، يتم إلغاء تحديد checkbox الرئيسي
- **حالة متوسطة**: عند تحديد بعض العناصر، يظهر checkbox الرئيسي في حالة متوسطة

### 2. التصدير المرن
- **تصدير كامل**: إذا لم يتم تحديد أي عنصر، يتم تصدير جميع البيانات
- **تصدير محدد**: إذا تم تحديد عناصر، يتم تصدير العناصر المحددة فقط
- **دمج الفلاتر**: يتم دمج التحديد مع فلاتر البحث الأخرى

### 3. واجهة المستخدم
- **أزرار واضحة**: أزرار التصدير مع أيقونات واضحة
- **رسائل تأكيد**: رسائل تأكيد قبل التصدير
- **تغذية راجعة بصرية**: تغيير مظهر checkboxes عند التحديد

## الأمان
- **التحقق من الصلاحيات**: جميع عمليات التصدير محمية بتسجيل دخول الإدارة
- **تنظيف البيانات**: تنظيف معرفات العناصر المحددة لمنع الهجمات
- **التحقق من الصحة**: التحقق من صحة معرفات العناصر قبل التصدير

## التوافق
- **المتصفحات**: يعمل على جميع المتصفحات الحديثة
- **الأجهزة**: متوافق مع الأجهزة المكتبية والمحمولة
- **الأنظمة**: يعمل على Windows, Mac, Linux

## التحديثات المستقبلية
- إضافة إجراءات جماعية أخرى (حذف، تعديل، إلخ)
- إضافة تصدير بتنسيقات أخرى (Word, JSON)
- إضافة حفظ التحديدات في الجلسة
- إضافة تصدير مجدول
